<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>论文项目进度 - 学术方舟</title>
    <link rel="stylesheet" href="css/main.css">
    <script>
     var _hmt = _hmt || [];
     (function() {
       var hm = document.createElement("script");
       hm.src = "https://hm.baidu.com/hm.js?e96eb58d2eae5768251e6ca734b6f227";
       var s = document.getElementsByTagName("script")[0];
       s.parentNode.insertBefore(hm, s);
     })();
    </script>
    
    <!-- 日期刻度脚本 -->
    <script>
        // 在页面加载完成后添加日期刻度
        document.addEventListener('DOMContentLoaded', function() {
            // 获取日历线元素
            const calendarLine = document.getElementById('date-scale-line');
            if (!calendarLine) return;
            
            // 获取所有的星期列
            const weekColumns = document.querySelectorAll('.week-column');
            if (weekColumns.length === 0) return;
            
            // 计算过去最近的一个周一的日期
            function getLastMonday() {
                const today = new Date();
                const day = today.getDay();
                // 如果今天是周日(0)，则减去6天；如果是周一(1)，则减去0天；其他情况减去(day-1)天
                const diff = today.getDate() - (day === 0 ? 6 : day - 1);
                const lastMonday = new Date(today.setDate(diff));
                return lastMonday;
            }
            
            // 格式化日期为24Oct这样的格式
            function formatDate(date) {
                const day = date.getDate();
                const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                const month = monthNames[date.getMonth()];
                return `${day}${month}`;
            }
            
            // 获取过去最近的周一
            const lastMonday = getLastMonday();
            // 跟踪当前处理的周一日期
            let currentMonday = new Date(lastMonday);
            // 跟踪已处理的周一数量
            let mondayCount = 0;
            
            // 为每个星期列添加刻度，确保每个星期文本都有对应的刻度线
            weekColumns.forEach((column, index) => {
                const weekDayElement = column.querySelector('.week-day');
                if (!weekDayElement) return; // 确保有星期文本
                
                // 获取列的实际位置信息，用于精确定位刻度线
                const columnRect = column.getBoundingClientRect();
                const calendarLineRect = calendarLine.getBoundingClientRect();
                
                // 计算刻度线在日历线上的相对位置（百分比）
                const percentPosition = ((columnRect.left + columnRect.width / 2 - calendarLineRect.left) / calendarLineRect.width) * 100;
                
                // 创建刻度元素
                const scale = document.createElement('div');
                scale.classList.add('date-scale');
                
                // 设置刻度位置，确保刻度线在文本上方
                scale.style.position = 'absolute';
                scale.style.top = '0';
                scale.style.left = `${percentPosition}%`;
                
                // 检查是否是周一
                const isMonday = weekDayElement.textContent.trim() === 'M';
                
                // 周一的刻度更宽
                scale.style.width = isMonday ? '3px' : '1px';
                scale.style.height = '8px';
                scale.style.backgroundColor = isMonday ? '#d9d9d9' : '#ccc';
                scale.style.transform = 'translateX(-50%)';
                
                // 添加到日历线
                calendarLine.appendChild(scale);
                
                // 如果是周一，添加日期显示
                if (isMonday) {
                    // 为第一个周一显示过去最近的周一日期，后续每个周一递增7天
                    const displayDate = formatDate(currentMonday);
                    
                    // 创建日期元素
                    const dateElement = document.createElement('div');
                    dateElement.classList.add('week-date');
                    dateElement.textContent = displayDate;
                    
                    // 添加到week-column
                    column.appendChild(dateElement);
                    
                    // 递增到下一个周一
                    currentMonday.setDate(currentMonday.getDate() + 7);
                    mondayCount++;
                }
            });
        });
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
        }
        
        /* Logo样式 */
        .logo-container {
            background-color: white;
            width: 100%;
            padding: 20px 30px;
            display: flex;
            align-items: center;
        }
        
        .logo-icon {
            max-width: 100%;
            height: auto;
            object-fit: contain;
        }
        
        .content-wrapper {
            flex: 1;
            height: 100vh;
            display: flex;
        }
        
        .sidebar {
            width: 80px;
            background-color: #ffffff;
            color: #333333;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 10px;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            border-right: 1px solid #e0e0e0;
            margin-top: 0;
            flex-shrink: 0;
        }
        
        .sidebar-item {
            text-align: center;
            padding: 10px 10px;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 8px;
        }
        
        .sidebar-item:hover {
            background-color: #f3e5f5;
            transform: translateX(5px);
        }
        
        
        .sidebar-icon {
            width: 24px;
            height: 24px;
            margin-bottom: 5px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            font-size: 0;
            color: transparent;
        }
        
        .sidebar-text {
            font-size: 12px;
            white-space: nowrap;
        }
        
        .main-content {
            flex: 1;
            min-width: 0;
            overflow: hidden;
        }
        
        .app-container {
            margin: 0;
            padding: 0 0px;
            width: 100%;
            height: 100%;
            overflow: auto;
        }
        
        /* 论文信息头部 */
        .project-header {
            background-color: transparent;
            padding: 0px 0px;
            margin-bottom: 0;
        }
        
        .project-info {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            margin-bottom: 15px;
        }
        
        .project-title {
            font-size: 22px;
            font-weight: 600;
            color: #2c3e50;
            margin-right: 5px;
        }
        
        .project-meta {
            font-size: 14px;
            color: #666;
        }
        
        /* 日历区域 */
        .calendar-section {
            background-color: transparent;
        }
        
        /* 日历导航样式 */
        .calendar-nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            padding-left: 7.5px;
            padding-right: 7.5px;
        }
        
        .calendar-nav button {
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px;
            color: #666;
            font-size: 18px;
        }
        
        .calendar-nav button:hover {
            color: #3498db;
        }
        
        .current-date {
            font-weight: 600;
            color: #2c3e50;
        }
        
        .calendar-dots {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }
        
        .dot-purple {
            background-color: #9b59b6;
        }
        
        .dot-blue {
            background-color: #3498db;
        }
        
        .calendar-grid {
            display: flex;
            position: relative;
        }
        
        .calendar-weeks {
            display: flex;
            gap: 15px;
            width: 100%;
        }
        
        .week-column {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            /* 移除左右padding，确保所有列宽度一致 */
            min-height: 60px; /* 确保足够的垂直空间 */
        }
        
        .week-day {
            font-size: 10px;
            color: #666;
            text-align: center;
            z-index: 1;
            width: auto;
            margin-top: 35px; /* 确保所有星期文本(M、T、W、T等)与时间轴顶部距离一致 */
            margin-bottom: 0; /* 确保一致的底部边距 */
            padding: 0; /* 移除内边距 */
        }
        
        .week-date {
            font-size: 10px;
            color: #999;
            margin-top: 3px;
            text-align: center;
            position: relative;
            top: 0; /* 确保日期文本不影响星期文本的垂直位置 */
            padding: 0;
        }
        
        .calendar-line {
            position: absolute;
            top: 30px;
            left: 0;
            right: 0;
            height: 2px;
            background-color: #e0e0e0;
            z-index: 0;
        }
        
        /* 调整.week-column使其内容垂直居中 */
        .calendar-weeks {
            display: flex;
            gap: 15px;
            width: 100%;
            align-items: center;
        }
        
        
        
        .marker-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin: 0 auto;
        }
        
        /* 当天位置的空心圆圈 */
        .current-day-circle {
            position: absolute;
            top: 22px;
            left: 50%;
            transform: translateX(-50%);
            width: 16px;
            height: 16px;
            border: 2px solid #00CFC8;
            border-radius: 50%;
            background-color: transparent;
            z-index: 2;
        }
        
        .marker-dot.purple {
            background-color: #9b59b6;
            display: none;
        }
        
        .marker-dot.blue {
            background-color: #3498db;
            display: none;
        }
        
        .current-day-bubble {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #00CFC8;
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 12px;
            white-space: nowrap;
        }
        
        /* 阶段进度 */
        .progress-section {
            background-color: transparent;
            padding: 25px 0px;
            overflow-x: auto;
        }
        
        .progress-stages {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: nowrap;
        }
        
        .stage {
            min-width: 300px;
            background-color: transparent;
        }
        
        .stage-purple {
            color: #9b59b6;
        }
        
        .stage-blue {
            color: #3498db;
        }
        
        .stage-green {
            color: #2ecc71;
        }
        
        .stage-orange {
            color: #e67e22;
        }
        
        .stage-name {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 10px;
            padding: 5px 10px;
            border-radius: 6px;
        }
        
        .stage-purple .stage-name {
            color: #9b59b6;
            background-color: #f3e5f5;
            border-radius: 6px;
        }
        
        .stage-blue .stage-name {
            color: #3498db;
            background-color: rgba(52, 152, 219, 0.1);
        }
        
        .stage-green .stage-name {
            color: #2ecc71;
            background-color: rgba(46, 204, 113, 0.1);
        }
        
        .stage-orange .stage-name {
            color: #e67e22;
            background-color: rgba(230, 126, 34, 0.1);
        }
        
        /* 阶段标题样式 */
        .progress-stages {
            display: flex;
            align-items: flex-start;
        }
        
              
        .stage-items {
            margin-top: 15px;
        }
        
        .stage-item {
            padding: 10px;
            margin-bottom: 10px;
            background-color: white;
            border-radius: 10px;
        }
        
        .item-tools {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .item-tools .tool-btn {
    flex: 0 0 calc((100% - 10px) / 2);
    max-width: calc((100% - 10px) / 2);
    background-size: cover;
    background-repeat: no-repeat;
    background-position: center;
    padding-left: 10px;
    color: transparent;
    font-size: 0;
    text-indent: -9999px;
}
        

        
        .stage-item-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        .item-title {
            font-size: 14px;
            font-weight: 500;
        }
        
        .item-status {
            width: 12px;
            height: 12px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            font-size: 0;
            text-indent: -9999px;
            color: transparent;
        }
        
        .item-desc {
            font-size: 12px;
            color: #666;
        }
        
        .item-tools {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .tool-btn {
            padding: 6px 12px;
            border-radius: 6px;
            background-color: white;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }
        
        .tool-btn:hover {
            background-color: #f1f1f1;
            border-color: #ccc;
        }
    </style>
</head>
<body>
    <!-- Logo区域 - 占满整行，白色背景 -->
    <div class="logo-container">
        <img src="assets/logo_black.png" alt="Logo" class="logo-icon" />
    </div>

    <!-- 内容区域容器 -->
    <div class="content-wrapper">
        <!-- 侧边栏 -->
        <div class="sidebar">
            <div class="sidebar-item">
                <div class="sidebar-icon">📋</div>
                <div class="sidebar-text">项目</div>
            </div>
            <div class="sidebar-item">
                <div class="sidebar-icon">📜</div>
                <div class="sidebar-text">历史</div>
            </div>
            <div class="sidebar-item">
                <div class="sidebar-icon">💬</div>
                <div class="sidebar-text">消息</div>
            </div>
            <div class="sidebar-item">
                <div class="sidebar-icon">💬</div>
                <div class="sidebar-text">文库</div>
            </div>
            <div class="sidebar-item">
                <div class="sidebar-icon">💬</div>
                <div class="sidebar-text">应用</div>
            </div>
            <div class="sidebar-item">
                <div class="sidebar-icon">💬</div>
                <div class="sidebar-text">投稿</div>
            </div>
            <div class="sidebar-item">
                <div class="sidebar-icon">👤</div>
                <div class="sidebar-text">我的</div>
            </div>

        </div>
        
        <!-- 主内容区域 -->
        
        <div class="main-content">
        <div class="app-container">
        <!-- 论文信息头部 -->
        <div class="project-header">
            <div class="project-info">
                <h1 class="project-title" id="display-project-name">我的论文项目</h1><span style="margin: 0 8px; color: #aaa; align-self: center;">|</span><div class="project-meta" id="display-major-education">计算机专业 · 本科</div>
            </div>
        </div>
        
        <!-- 日历区域 -->
        <div class="calendar-section">
            <!-- 第一行：左右尖括号导航 -->
            <div class="calendar-nav">
                <button id="prev-month">&lt;</button>
                
                <button id="next-month">&gt;</button>
            </div>
            
            <!-- 第二行：时间刻度和星期标识 -->
            <div class="calendar-grid">
                <div class="calendar-line" id="date-scale-line"></div>
                <div class="calendar-weeks">
                    <!-- 时间刻度和星期标识 -->
                    <div class="week-column">
                        <div class="week-day">M</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">T</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">W</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">T</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">F</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">S</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">S</div>
                    </div>
                    
                    <!-- 第二周 -->
                    <div class="week-column">
                        <div class="week-day">M</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">T</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">W</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">T</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">F</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">S</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">S</div>
                    </div>
                    
                    <!-- 第三周 -->
                    <div class="week-column">
                        <div class="week-day">M</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">T</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">W</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">T</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">F</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">S</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">S</div>
                    </div>
                    
                    <!-- 后续周次，样式类似 -->
                    <div class="week-column">
                        <div class="week-day">M</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">T</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">W</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">T</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">F</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">S</div>
                    </div>
                    <div class="week-column">
                        <div class="week-day">S</div>
                    </div>
                    
                    <div class="week-column">
                        <div class="week-day">M</div>
                    </div>
                    <!-- 更多列可以根据需要添加 -->
                </div>
            </div>
        </div>
        
        <!-- 阶段进度 -->
        <div class="progress-section">
            <div class="progress-stages">
                <!-- 阶段一 -->
                <div class="stage stage-purple">
                    <div class="stage-name">阶段一：准备与开题</div>
                    
                    <div class="stage-items">
                        <div class="stage-item">
                            <div class="stage-item-header">
                                <div class="item-title">选题</div>
                                <div class="item-status">已完成</div>
                            </div>
                            <div class="item-desc">2025.10.01~2025.10.31</div>
                            <div class="item-features">基于研究方法选题 | 真实参考文献 | 专业选题评估分析报告</div>
                            <div class="progress-container">
                                <div class="progress-bar completed" style="width: 100%"></div>
                            </div>
                            <div class="item-tools">
                                <button class="tool-btn" onclick="window.location.href='topic-selection.html'">AI选题</button>
                                <button class="tool-btn" onclick="window.location.href='topic-appraise.html'">AI选题评估</button>
                            </div>
                        </div>
                        
                        <div class="stage-item">
                            <div class="stage-item-header">
                                <div class="item-title">开题报告</div>
                                <div class="item-status">进行中</div>
                            </div>
                            <div class="item-desc">2025.11.01~2025.11.30</div>
                            <div class="item-features">真实参考文献 | 文献引用标注 | 免费生成大纲｜补充资料投喂AI</div>
                            <div class="progress-container">
                                <div class="progress-bar in-progress" style="width: 45%"></div>
                            </div>
                            <div class="item-tools">
                                <button class="tool-btn" onclick="navigateToProposal()">AI开题报告</button>
                                <button class="tool-btn" onclick="navigateToProposalEvaluation()">AI开题报告评估</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 阶段二 -->
                <div class="stage stage-blue">
                    <div class="stage-name">阶段二：论文写作</div>
                    
                    <div class="stage-items">
                        <div class="stage-item">
                            <div class="stage-item-header">
                                <div class="item-title">撰写论文</div>
                                <div class="item-status">未开始</div>
                            </div>
                            <div class="item-desc">2025.12.01~2026.04.30</div>
                            <div class="item-features">真实参考文献 | 支持自定义文献｜文献引用标注 | 免费生成大纲｜补充资料投喂AI</div>
                            <div class="progress-container">
                                <div class="progress-bar not-started" style="width: 0%"></div>
                            </div>
                            <div class="item-tools">
                                <button class="tool-btn" onclick="navigateToWritePaper()">AI论文写作</button>
                                <button class="tool-btn">文献检索</button>
                                <button class="tool-btn">AI文献综述</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 阶段三 -->
                <div class="stage stage-green">
                    <div class="stage-name">阶段三：论文审核与修改</div>
                    
                    <div class="stage-items">
                        <div class="stage-item">
                            <div class="stage-item-header">
                                <div class="item-title">论文审核</div>
                                <div class="item-status">未开始</div>
                            </div>
                            <div class="item-desc">2026.05.01~2026.05.12</div>
                            <div class="item-features">精准度高 | 论文逐句分析｜文本检测｜可视化标注｜文档格式快捷调整</div>
                            <div class="progress-container">
                                <div class="progress-bar not-started" style="width: 0%"></div>
                            </div>
                            <div class="item-tools">
                                <button class="tool-btn">AI论文查重</button>
                                <button class="tool-btn">AIGC检测</button>
                                <button class="tool-btn">AI格式审核</button>
                            </div>
                        </div>
                        
                        <div class="stage-item">
                            <div class="stage-item-header">
                                <div class="item-title">论文修改</div>
                                <div class="item-status">未开始</div>
                            </div>
                            <div class="item-desc">2026.05.13~2026.06.10</div>
                            <div class="item-features">强力降重，疑似度降低50% 左右｜智能降重 | 轻、中、重度降重 | 报告内容一键复制</div>
                            <div class="progress-container">
                                <div class="progress-bar not-started" style="width: 0%"></div>
                            </div>
                            <div class="item-tools">
                                <button class="tool-btn">AI论文降重</button>
                                <button class="tool-btn">AIGC降重</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 阶段四 -->
                <div class="stage stage-orange">
                    <div class="stage-name">阶段四：答辩与定稿</div>
                    
                    <div class="stage-items">
                        <div class="stage-item">
                            <div class="stage-item-header">
                                <div class="item-title">论文答辩</div>
                                <div class="item-status">未开始</div>
                            </div>
                            <div class="item-desc">2026.06.10~2026.06.30</div>
                            <div class="item-features">与论文高度贴合 | 可选择PPT页数 | 提供答辩稿、答辩问答增值服务</div>
                            <div class="progress-container">
                                <div class="progress-bar not-started" style="width: 0%"></div>
                            </div>
                            <div class="item-tools">
                                <button class="tool-btn">AI答辩PPT</button>
                                <button class="tool-btn">AI模拟答辩</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>
        </div>
    </div>

    <script>
        // 页面加载时获取项目信息
        document.addEventListener('DOMContentLoaded', function() {
            // 优先从全局变量获取项目信息，如果不存在则从localStorage获取
            let projectName = window.globalProjectName || localStorage.getItem('projectName') || '我的论文项目';
            let major = window.globalMajor || localStorage.getItem('major') || '计算机';
            let education = window.globalEducation || localStorage.getItem('education') || '本科';
            
            // 更新全局变量，确保一致性
            window.globalProjectName = projectName;
            window.globalMajor = major;
            window.globalEducation = education;
            
            // 显示项目名称和专业学历
            const projectNameElement = document.getElementById('display-project-name');
            const majorEducationElement = document.getElementById('display-major-education');
            
            if (projectNameElement) {
                projectNameElement.textContent = projectName;
            }
            
            if (majorEducationElement) {
                majorEducationElement.textContent = `${major}专业 · ${education}`;
            }
            
            
            // 日历导航按钮事件
            const prevMonthBtn = document.getElementById('prev-month');
            const nextMonthBtn = document.getElementById('next-month');
            const currentDateElement = document.getElementById('current-date');
            
            if (prevMonthBtn && nextMonthBtn && currentDateElement) {
                prevMonthBtn.addEventListener('click', function() {
                    // 这里可以添加切换到上个月的逻辑
                    alert('切换到上个月');
                });
                
                nextMonthBtn.addEventListener('click', function() {
                    // 这里可以添加切换到下个月的逻辑
                    alert('切换到下个月');
                });
            }
            
            // 为按钮设置背景图片
            const toolButtons = document.querySelectorAll('.tool-btn');
            toolButtons.forEach(button => {
                const buttonText = button.textContent.trim();
                // 检查assets目录是否有对应的图片文件
                const imagePath = `assets/${buttonText}.png`;
                // 创建一个图片对象来检测图片是否存在
                const img = new Image();
                img.onload = function() {
                    // 图片存在,设置为按钮背景
                    button.style.backgroundImage = `url('${imagePath}')`;
                };
                img.onerror = function() {
                    // 图片不存在,不设置背景
                    console.log(`未找到图片: ${imagePath}`);
                };
                img.src = imagePath;
            });
            
            // 为侧边栏图标设置背景图片
            const sidebarItems = document.querySelectorAll('.sidebar-item');
            sidebarItems.forEach(item => {
                const iconElement = item.querySelector('.sidebar-icon');
                const textElement = item.querySelector('.sidebar-text');
                if (iconElement && textElement) {
                    const iconText = textElement.textContent.trim();
                    const imagePath = `assets/${iconText}.png`;
                    // 创建一个图片对象来检测图片是否存在
                    const img = new Image();
                    img.onload = function() {
                        // 图片存在,设置为图标背景
                        iconElement.style.backgroundImage = `url('${imagePath}')`;
                    };
                    img.onerror = function() {
                        // 图片不存在,不设置背景
                        console.log(`未找到侧边栏图片: ${imagePath}`);
                    };
                    img.src = imagePath;
                }
            });
            
            // 为状态元素设置背景图片
            const statusElements = document.querySelectorAll('.item-status');
            statusElements.forEach(statusElement => {
                const statusText = statusElement.textContent.trim();
                const imagePath = `assets/${statusText}.png`;
                // 创建一个图片对象来检测图片是否存在
                const img = new Image();
                img.onload = function() {
                    // 图片存在,设置为状态背景
                    statusElement.style.backgroundImage = `url('${imagePath}')`;
                };
                img.onerror = function() {
                    // 图片不存在,不设置背景
                    console.log(`未找到状态图片: ${imagePath}`);
                };
                img.src = imagePath;
            });
            
            // 在时间轴上标注今天的位置
            function markTodayOnTimeline() {
                const today = new Date();
                const dayOfWeek = today.getDay(); // 0=周日, 1=周一, ..., 6=周六
                
                // 计算最近的周一(过去的)
                const daysFromMonday = (dayOfWeek === 0) ? 6 : (dayOfWeek - 1);
                const lastMonday = new Date(today);
                lastMonday.setDate(today.getDate() - daysFromMonday);
                
                // 计算今天距离最近周一的天数
                const daysSinceMonday = Math.floor((today - lastMonday) / (1000 * 60 * 60 * 24));
                
                // 获取所有week-column元素
                const weekColumns = document.querySelectorAll('.week-column');
                
                if (weekColumns.length > daysSinceMonday) {
                    const targetColumn = weekColumns[daysSinceMonday];
                    
                    // 创建圆圈标记元素
                    const todayMarker = document.createElement('div');
                    todayMarker.style.position = 'absolute';
                    todayMarker.style.top = '24px'; // 圆圈穿过时间轴，中心略高于轴线
                    todayMarker.style.left = '50%';
                    todayMarker.style.transform = 'translateX(-50%)';
                    todayMarker.style.width = '6px';
                    todayMarker.style.height = '6px';
                    todayMarker.style.borderRadius = '50%';
                    todayMarker.style.border = '1px solid #00CFC8';
                    todayMarker.style.backgroundColor = 'transparent';
                    todayMarker.style.zIndex = '5'; // 确保圆圈显示在时间轴线上方
                    
                    // 创建气泡弹框
      const todayBubble = document.createElement('div');
      const today = new Date();
      const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
      const dateStr = `${today.getDate()}${months[today.getMonth()]}`;
      todayBubble.textContent = `today,${dateStr}`;
                    todayBubble.style.position = 'absolute';
      todayBubble.style.top = '-12px'; // 圆圈上方,非常接近圆圈
                    todayBubble.style.left = '50%';
                    todayBubble.style.transform = 'translateX(-50%)';
                    todayBubble.style.backgroundColor = '#00CFC8';
                    todayBubble.style.color = 'white';
                    todayBubble.style.padding = '4px 8px';
                    todayBubble.style.borderRadius = '4px';
                    todayBubble.style.fontSize = '12px';
                    todayBubble.style.whiteSpace = 'pre-line';
                    todayBubble.style.textAlign = 'center';
                    todayBubble.style.zIndex = '6';
                    todayBubble.style.lineHeight = '1.4';
                    
                    // 将圆圈添加到对应的列中
                    targetColumn.style.position = 'relative';
                    targetColumn.appendChild(todayMarker);
                    targetColumn.appendChild(todayBubble);
                }
            }
            
            // 添加时间节点气球标记
            // daysOffset: 今天之后的天数偏移，默认为2
            // customColor: 自定义气球颜色，如果不提供则根据日期自动判断阶段颜色
            function addMilestoneBalloon(daysOffset = 2, customColor = null) {
                const today = new Date();
                const dayOfWeek = today.getDay(); // 0=周日, 1=周一, ..., 6=周六
                
                // 计算最近的周一(过去的)
                const daysFromMonday = (dayOfWeek === 0) ? 6 : (dayOfWeek - 1);
                const lastMonday = new Date(today);
                lastMonday.setDate(today.getDate() - daysFromMonday);
                
                // 计算气球位置
                const daysSinceMonday = Math.floor((today - lastMonday) / (1000 * 60 * 60 * 24));
                const balloonDayIndex = daysSinceMonday + daysOffset;
                
                // 获取所有week-column元素
                const weekColumns = document.querySelectorAll('.week-column');
                
                if (weekColumns.length > balloonDayIndex) {
                    const targetColumn = weekColumns[balloonDayIndex];
                    
                    // 根据日期判断当前阶段并获取对应颜色
                    let stageColor;
                    if (customColor) {
                        stageColor = customColor; // 使用自定义颜色
                    } else {
                        const balloonDate = new Date(today);
                        balloonDate.setDate(today.getDate() + daysOffset);
                        stageColor = '#9b59b6'; // 默认紫色(阶段一)
                    
                        const balloonDateStr = balloonDate.toISOString().split('T')[0];
                        // 阶段一：2025.10.01~2025.11.30 - 紫色
                        if (balloonDateStr >= '2025-10-01' && balloonDateStr <= '2025-11-30') {
                            stageColor = '#9b59b6';
                        }
                        // 阶段二：2025.12.01~2026.04.30 - 蓝色
                        else if (balloonDateStr >= '2025-12-01' && balloonDateStr <= '2026-04-30') {
                            stageColor = '#3498db';
                        }
                        // 阶段三：2026.05.01~2026.06.10 - 绿色
                        else if (balloonDateStr >= '2026-05-01' && balloonDateStr <= '2026-06-10') {
                            stageColor = '#2ecc71';
                        }
                        // 阶段四：2026.06.10~2026.06.30 - 橙色
                        else if (balloonDateStr >= '2026-06-10' && balloonDateStr <= '2026-06-30') {
                            stageColor = '#e67e22';
                        }
                    }
                    
                    // 创建气球容器
                    const balloonContainer = document.createElement('div');
                    balloonContainer.style.position = 'absolute';
                    balloonContainer.style.top = '-20px'; // 气球在时间轴上方,靠近连接线
                    balloonContainer.style.left = '50%';
                    balloonContainer.style.transform = 'translateX(-50%)';
                    balloonContainer.style.zIndex = '7';
                    
                    // 创建气球主体
                    const balloon = document.createElement('div');
                    balloon.style.width = '16px'; // 缩小气球宽度
                    balloon.style.height = '20px'; // 缩小气球高度
                    balloon.style.backgroundColor = stageColor;
                    balloon.style.borderRadius = '50% 50% 50% 50% / 60% 60% 40% 40%'; // 气球形状
                    balloon.style.position = 'relative';
                    balloon.style.boxShadow = '0 2px 4px rgba(0,0,0,0.2)';
                    
                    // 创建气球底部的小三角(绳结)
                    const balloonTail = document.createElement('div');
                    balloonTail.style.position = 'absolute';
                    balloonTail.style.bottom = '-4px';
                    balloonTail.style.left = '50%';
                    balloonTail.style.transform = 'translateX(-50%)';
                    balloonTail.style.width = '0';
                    balloonTail.style.height = '0';
                    balloonTail.style.borderLeft = '3px solid transparent';
                    balloonTail.style.borderRight = '3px solid transparent';
                    balloonTail.style.borderTop = `4px solid ${stageColor}`;
                    
                    // 创建绳子
                    const balloonString = document.createElement('div');
                    balloonString.style.position = 'absolute';
                    balloonString.style.top = '30px'; // 从时间轴位置开始
                    balloonString.style.left = '50%';
                    balloonString.style.transform = 'translateX(-50%)';
                    balloonString.style.width = '1px';
                    balloonString.style.height = '15px'; // 调整绳子长度
                    balloonString.style.backgroundColor = '#999';
                    
                    // 组装气球
                    balloon.appendChild(balloonTail);
                    balloonContainer.appendChild(balloon);
                    balloonContainer.appendChild(balloonString);
                    
                    // 将气球添加到对应的列中
                    targetColumn.style.position = 'relative';
                    targetColumn.appendChild(balloonContainer);
                }
            }
            
            // 页面加载完成后标注今天的位置
            markTodayOnTimeline();
            
            // 添加时间节点气球标记
            addMilestoneBalloon();
            
            // 添加阶段二的蓝色气球标记
            addMilestoneBalloon(8, '#3498db'); // 阶段二位置，蓝色
        });
        
        // 跳转到开题报告页面并传递参数
        function navigateToProposal() {
            // 获取当前项目信息
            const projectName = window.globalProjectName || localStorage.getItem('projectName') || '我的论文项目';
            const major = window.globalMajor || localStorage.getItem('major') || '计算机';
            const education = window.globalEducation || localStorage.getItem('education') || '本科';
            
            // 构建URL参数
            const params = new URLSearchParams();
            params.append('title', '开题报告');
            params.append('prompt', 'PROJECT_PROPOSAL_PROMPT');
            params.append('projectName', projectName);
            params.append('major', major);
            params.append('education', education);
            
            // 跳转到topic-selection.html并带上参数
            window.location.href = `topic-selection.html?${params.toString()}`;
        }
        
        // 跳转到开题报告评估页面并传递参数
        function navigateToProposalEvaluation() {
            // 获取当前项目信息
            const projectName = window.globalProjectName || localStorage.getItem('projectName') || '我的论文项目';
            const major = window.globalMajor || localStorage.getItem('major') || '计算机';
            const education = window.globalEducation || localStorage.getItem('education') || '本科';
            
            // 构建URL参数
            const params = new URLSearchParams();
            params.append('title', '开题报告评估');
            params.append('prompt', 'PROJECT_PROPOSAL_EVALUATION_PROMPT');
            params.append('projectName', projectName);
            params.append('major', major);
            params.append('education', education);
            
            // 跳转到topic-selection.html并带上参数
            window.location.href = `topic-selection.html?${params.toString()}`;
        }
        
        // 跳转到AI论文写作页面并传递参数
        function navigateToWritePaper() {
            // 获取当前项目信息
            const projectName = window.globalProjectName || localStorage.getItem('projectName') || '我的论文项目';
            const major = window.globalMajor || localStorage.getItem('major') || '计算机';
            const education = window.globalEducation || localStorage.getItem('education') || '本科';
            
            // 构建URL参数
            const params = new URLSearchParams();
            params.append('title', 'AI论文写作');
            params.append('prompt', 'WRITE_PAPER_PROMPT');
            params.append('projectName', projectName);
            params.append('major', major);
            params.append('education', education);
            
            // 跳转到topic-selection.html并带上参数
            window.location.href = `topic-selection.html?${params.toString()}`;
        }
    </script>
</body>
</html>